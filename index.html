<script>
  // Base64 encoded question-answer pairs
  const encodedData = [
    { q: "MSBJTlsgNTAgTUlMTElPTiwgRlJPTSBSRUQgVE8gVEhFIENPTE9SIG9mIFRIRSBTRUE=", a: "Ymx1ZSBsb2JzdGVy" },
    { q: "Qk9STiBGUk9NIFNUT05FLCBZRVRBTElWRSBJIEdST1c7IE15IEFSTVMgRU1CUkFDRSBCVVQgTkVWRVIgTEVUIEdP", a: "Y29yYWw=" },
    { q: "QSBNT1VOVEFJTiBUSEFUIFdBTFBLUywgQSBGT1JFU1QgVEhBVCBISURFUzsgSSBCUkVBVEggVEhST1VHSCBNWSBUQUlMLCBBTkQgREFOQ0UgT04gVEhFIFRJRURT", a: "d2hhbGUgc2hhcms=" },
    { q: "SSBTRA==IFdJVEhPVVQgTElQUywgQU5EIFRIRSBPTkxZIFNPVU5EIEknVkUgQ0FVZ0hU", a: "dGhlIGJsb29w" },
    { q: "SSdNIEEgR0lBTlQgVEhBVCBET0VTIE5PVEdST1csIEEgVFJBVkVMRVIgV0lUSE9VVCBOTyBGRUVULiBJIENBTiBETVJPV04gU0hJUFMgQlVUIE5FVkVSIERSSU5L", a: "YSB3YXZl" }
  ];

  // Simple Base64 decoder
  function decodeBase64(str) {
    try {
      return decodeURIComponent(escape(atob(str)));
    } catch {
      return "[Decoding error]";
    }
  }

  // Decode all questions and answers
  const allQuestions = encodedData.map(pair => ({
    question: decodeBase64(pair.q),
    answer: decodeBase64(pair.a)
  }));

  const selectedQuestions = allQuestions.sort(() => 0.5 - Math.random()).slice(0, 5);
  let currentQuestionIndex = 0;

  function updateQuestion() {
    if (currentQuestionIndex < selectedQuestions.length) {
      const q = selectedQuestions[currentQuestionIndex];
      document.getElementById("currentQuestion").textContent = q.question;
      document.getElementById("questionNum").textContent = `QUESTION ${currentQuestionIndex + 1} OF 5`;
      document.getElementById("answerInput").value = "";
      document.getElementById("response").className = "response";
      document.getElementById("response").textContent = "";
      document.getElementById("progressBar").style.width = `${(currentQuestionIndex / selectedQuestions.length) * 100}%`;
    } else {
      document.getElementById("currentQuestion").textContent = "QUESTIONS COMPLETED!";
      document.getElementById("questionNum").textContent = "COMPLETED";
      document.getElementById("answerInput").style.display = "none";
      document.querySelector("button").style.display = "none";
      document.getElementById("progressBar").style.width = "100%";
      document.getElementById("codeDisplay").style.display = "block";
    }
  }

  function checkAnswer() {
    const userAnswer = document.getElementById("answerInput").value.toLowerCase().trim();
    const responseEl = document.getElementById("response");
    const currentQ = selectedQuestions[currentQuestionIndex];
    const correct = userAnswer === currentQ.answer.toLowerCase();

    if (correct) {
      responseEl.textContent = "✓ CORRECT!";
      responseEl.className = "response correct show";
      currentQuestionIndex++;
      setTimeout(updateQuestion, 1000);
    } else {
      responseEl.textContent = "✗ INCORRECT - TRY AGAIN";
      responseEl.className = "response incorrect show";
    }
  }

  document.addEventListener('DOMContentLoaded', function() {
    updateQuestion();
    document.getElementById("answerInput").addEventListener("keypress", function(e) {
      if (e.key === "Enter") checkAnswer();
    });

    // Bubble animation
    const bubblesContainer = document.getElementById("bubbles");
    setInterval(() => {
      const bubble = document.createElement("div");
      bubble.classList.add("bubble");
      bubble.style.left = `${Math.random() * 100}%`;
      bubble.style.animationDuration = `${6 + Math.random() * 4}s`;
      bubble.style.width = bubble.style.height = `${10 + Math.random() * 10}px`;
      bubblesContainer.appendChild(bubble);
      setTimeout(() => bubble.remove(), 10000);
    }, 300);
  });
</script>
